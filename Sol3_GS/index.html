<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74422135-1', 'auto');
  ga('send', 'pageview');
  ga('send', 'event', 'category', 'action');

</script>
  </head>
  <body>
  <script>
  function handleFormSubmit(formObject) {
        google.script.run.generateEvents(formObject);
      }
    function setupTriggers(formObject){
        google.script.run.createTimeDrivenTriggers(formObject);
      }
  </script> 
    <h2>Please select the dates to extract events</h2>
    <div>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.9.1.js"></script>
  <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <form id="form1" onsubmit="handleFormSubmit(this)">
    Choose Start Date : <input type="text" name="startDate" id="startDatepicker" />
    Choose End Date : <input type="text" name="endDate" id="endDatepicker" />
    <input type="submit" value="Submit"></input>   
  </form><br/><br/><br/><br/><br/><br/>
  </div>
  <a href="http://www.google.com" onclick="trackOutboundLink('http://www.example.com'); return false;">Check out example.com</a>
  <div style="border: thin solid black">
  <h2>Set email reminders</h2> 
  <form id="form2" onsubmit="setupTriggers(this)">
  <input type="radio" name="groupInterval" value="Minute"> Minute Interval: <input type="text" name="minuteInterval" /><br/><br>
<input type="radio" name="groupInterval" value="Hour"> Hour Interval: <input type="text" name="hourInterval" /><br>
   &nbsp; &nbsp;<input type="submit" value="Setup reminder"></input>
  </form>
  <br/>
  </div>
<script>
$("#startDatepicker").datepicker();
$("#endDatepicker").datepicker();
</script>
<script>
// Pass input dates to server-side submitDates()
function submitDates() {
  var startDate = $("#startDatePicker").val();
  var endDate = $("#endDatePicker").val();

  google.script.run
        .withSuccessHandler(
           // Dates delivered, close dialog
           function() {
             google.script.host.close();
           })
           // Display failure messages
         .withFailureHandler(
           function() {
             var div = $('<div id="error" class="error">' + msg + '</div>');
             $(element).after($("#demo"));
           })
         .submitDates(startDate,endDate);
}
</script>
  </body>
</html>
